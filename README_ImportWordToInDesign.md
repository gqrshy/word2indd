# ImportWordToInDesign.jsx

Word文書(.docx)をInDesignにインポートし、段落スタイルを自動変換するスクリプトです。

## 対応環境

- Adobe InDesign 2025

## 機能概要

### 1. 段落スタイル変換

Word文書の段落スタイルをInDesignのスタイルに自動マッピングします：

| Wordスタイル | InDesignスタイル | 備考 |
|--------------|------------------|------|
| 大項目 | 大見出し1 | 先頭の■記号を自動削除 |
| 小項目 | 小項目 | □記号がない場合は自動追加 |
| 標準 | Normal | |
| 演習タイトル | 演習タイトル | |
| 図表番号 | 図番号 | |
| リスト | リスト | |
| 番号 | 番号リスト | |

### 2. フォント置換

| 置換前 | 置換後 |
|--------|--------|
| MS明朝 Bold | BIZ UDゴシック Regular |
| 表内のMS明朝（Regular/Bold） | BIZ UDゴシック Regular |

### 3. アンカードオブジェクト処理

Wordのテキストボックス（図として挿入されたもの）内のテキストに「コード・コマンド」スタイルを適用します。

### 4. 自動ページ追加

テキストがオーバーフローする場合、見開きページを自動追加してテキストフレームを連結します。

## 使用方法

1. InDesignでドキュメントを開く
2. `H-本文マスター` マスターページが存在することを確認
3. スクリプトパネルから `ImportWordToInDesign.jsx` を実行
4. インポートするWord文書(.docx)を選択
5. 確認ダイアログで「はい」をクリック

## 設定

スクリプト冒頭の `CONFIG` オブジェクトで動作をカスタマイズできます：

```javascript
var CONFIG = {
    autoCreatePages: true,       // 自動ページ追加
    maxSpreads: 100,             // 最大追加見開き数
    masterPagePrefix: "H",       // マスターページ接頭辞
    masterPageName: "本文マスター", // マスターページ名
    debugMode: true              // デバッグログ出力
};
```

## 処理結果

処理完了後、以下の情報がダイアログに表示されます：

- 既存ページ数
- 追加した見開き数
- インポートした段落数
- スタイル変換件数
- 小項目への□記号追加件数
- 図内テキストへのスタイル適用数
- フォント置換件数
- 表内フォント更新件数
- 処理時間

## 注意事項

- マスターページ「H-本文マスター」が必須です
- 埋め込みオブジェクト（Excel埋め込み表など）は正しく変換されない場合があります
- 埋め込みオブジェクトがある場合は、Wordで「表に変換」してからインポートしてください

## トラブルシューティング

### 「マスターページが見つかりません」エラー

`H-本文マスター` という名前のマスターページを作成してください。
